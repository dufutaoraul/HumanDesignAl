# 人类图开源项目技术选型对比

## 一、完整的人类图项目

### 1. hdkit ⭐ 135 stars
**GitHub**: https://github.com/jdempcy/hdkit

**技术栈**: JavaScript, React, Node.js, Ruby on Rails

**功能**:
- ✅ 生成完整的人类图（bodygraph）
- ✅ 计算26个行星闸门数据
- ✅ SVG 绘图功能
- ✅ 5个示例应用

**优点**:
- 专门为人类图设计的完整工具包
- 有React和Node.js示例
- 支持SVG Rave Mandala绘制
- 开源MIT许可

**缺点**:
- ⚠️ 2016年发布，更新较少
- ⚠️ 没有发布npm包（需要手动集成）
- ⚠️ 文档不够详细

**推荐指数**: ⭐⭐⭐⭐ (4/5)

---

### 2. SharpAstrology.HumanDesign ⭐ 38 stars
**GitHub**: https://github.com/CReizner/SharpAstrology.HumanDesign

**技术栈**: C# (.NET)

**功能**:
- ✅ 完整的人类图计算（类型、权威、轮回交叉）
- ✅ 支持过境图、合盘图
- ✅ 最新更新：2024年1月
- ✅ 活跃维护

**优点**:
- 功能最完整、最专业
- 代码质量高
- 持续维护中

**缺点**:
- ❌ C#语言，无法直接在JavaScript项目中使用
- ❌ 需要.NET环境

**推荐指数**: ⭐⭐ (2/5) - 技术栈不匹配

---

### 3. ProsperousHeart/HumanDesign ⭐ 16 stars
**GitHub**: https://github.com/ProsperousHeart/HumanDesign

**技术栈**: Python

**功能**:
- ❌ 不包含计算功能
- ✅ 教育资源和数据整理工具
- ✅ 数据导出到Excel

**推荐指数**: ⭐ (1/5) - 不适合我们的需求

---

## 二、天文计算库（可用于人类图计算）

### 1. swisseph-wasm ⭐⭐⭐⭐⭐ 推荐
**npm**: https://www.npmjs.com/package/swisseph-wasm

**技术栈**: WebAssembly + JavaScript

**功能**:
- ✅ 基于Swiss Ephemeris（天文学黄金标准）
- ✅ 极高精度的行星位置计算
- ✅ 支持浏览器和Node.js
- ✅ NASA JPL数据支持

**优点**:
- 🏆 业界最准确的天文计算库
- 🏆 WebAssembly性能优秀
- 🏆 有npm包，易于集成
- 🏆 适用于专业占星/人类图应用

**缺点**:
- ⚠️ 需要自己编写"行星位置→闸门"的映射逻辑
- ⚠️ 学习曲线稍陡

**安装**: `npm install swisseph-wasm`

**推荐指数**: ⭐⭐⭐⭐⭐ (5/5)

---

### 2. astronomia ⭐⭐⭐⭐
**npm**: https://www.npmjs.com/package/astronomia

**技术栈**: JavaScript

**功能**:
- ✅ VSOP87理论计算行星位置
- ✅ 基于Jean Meeus《天文算法》
- ✅ 最近更新：16天前（活跃维护）
- ✅ 10个项目在使用

**优点**:
- 纯JavaScript实现
- 持续维护
- 文档完善

**缺点**:
- 精度略低于Swiss Ephemeris
- 需要自己映射到闸门

**安装**: `npm i astronomia`

**推荐指数**: ⭐⭐⭐⭐ (4/5)

---

### 3. sweph (Node.js绑定) ⭐⭐⭐
**GitHub**: https://github.com/timotejroiko/sweph

**技术栈**: Node.js C++ binding

**功能**:
- ✅ Swiss Ephemeris的Node.js绑定
- ✅ 高精度

**缺点**:
- ⚠️ GPL-2.0许可（有开源要求）
- ⚠️ 只能在Node.js环境使用（不支持浏览器）

**推荐指数**: ⭐⭐⭐ (3/5)

---

### 4. mivion/ephemeris ⭐ 159 stars
**GitHub**: https://github.com/mivion/ephemeris

**技术栈**: JavaScript

**功能**:
- ✅ 纯JavaScript实现
- ✅ 基于Steve Moshier的工作

**缺点**:
- ⚠️ 更新不活跃
- ⚠️ GPL v2许可

**推荐指数**: ⭐⭐ (2/5)

---

## 三、推荐方案

### 🏆 最佳方案：swisseph-wasm + 自定义人类图逻辑

**为什么？**
1. ✅ **精度最高** - 基于瑞士星历表，NASA数据
2. ✅ **性能优秀** - WebAssembly加速
3. ✅ **易于集成** - npm包，支持Next.js
4. ✅ **浏览器兼容** - 前后端都能用
5. ✅ **专业级别** - 全球占星软件的标准

**实施步骤**:
```javascript
// 1. 安装
npm install swisseph-wasm

// 2. 计算行星位置
import swisseph from 'swisseph-wasm'

// 3. 将黄道度数映射到64闸门
// 每个闸门占 360° / 64 = 5.625°

// 4. 确定爻线（每个闸门6爻，每爻 5.625° / 6 = 0.9375°）

// 5. 生成26个行星闸门数据
```

**参考人类图的闸门-黄道映射表**:
- 需要一个64闸门对应黄道度数的映射表
- 这个数据可以从现有人类图软件反推或查阅资料

---

### 🥈 备选方案：hdkit（如果能跑通）

**优点**:
- 开箱即用的人类图解决方案
- 不需要自己编写映射逻辑

**缺点**:
- 需要研究源码并提取可用部分
- 可能需要大量调试

---

## 四、建议的技术架构

```
用户输入（出生时间+地点）
         ↓
   Next.js API Route
         ↓
   swisseph-wasm 计算行星位置
         ↓
   闸门映射逻辑（自定义）
         ↓
   生成26个行星闸门数据
         ↓
   计算通道、类型、权威等
         ↓
   存入 Supabase
         ↓
   SVG 绘图展示
```

---

## 五、下一步行动

1. ✅ **测试 swisseph-wasm** - 编写简单demo验证可用性
2. ✅ **研究闸门映射** - 找到或创建64闸门的黄道度数映射表
3. ✅ **编写计算API** - 实现完整的人类图计算逻辑
4. ⏸️ **备用方案** - 如果遇到困难，再研究hdkit源码

---

## 六、关键数据需求

为了将天文计算转换为人类图，我们需要：

1. **64闸门黄道映射表** - 每个闸门的起始度数
2. **13个行星** - Sun, Moon, Mercury, Venus, Mars, Jupiter, Saturn, Uranus, Neptune, Pluto, Earth, North Node, South Node
3. **设计日期计算** - 出生前88度（约88天）
4. **闸门↔通道映射** - 36条通道的闸门对
5. **通道↔类型映射** - 确定5种人类图类型的规则

这些数据我们可以手动整理或从现有人类图资源中提取。

---

**结论**: 推荐使用 **swisseph-wasm** 作为核心计算引擎，自行实现人类图特定逻辑。这样既保证了精度，又有完全的控制权和灵活性。
