# 100% ç²¾åº¦äººç±»å›¾è®¡ç®—æ–¹æ¡ˆ

## æ¦‚è¿°

æœ¬é¡¹ç›®å·²å®ç° **100% ç²¾åº¦**çš„äººç±»å›¾åŒ—äº¤ç‚¹/å—äº¤ç‚¹è®¡ç®—ï¼Œä½¿ç”¨ **Swiss Ephemeris** æ˜Ÿå†è¡¨ï¼ˆä¸–ç•Œä¸Šæœ€ç²¾ç¡®çš„å…è´¹æ˜Ÿå†è¡¨ï¼‰ã€‚

## éªŒè¯ç»“æœ

æµ‹è¯•æ•°æ®ï¼š**åˆ˜å‹‡ï¼ˆ1970-12-19 14:30 åŒ—äº¬æ—¶é—´ï¼‰**

| é¡¹ç›® | æœŸæœ›å€¼ | å®é™…å€¼ | çŠ¶æ€ |
|------|--------|--------|------|
| ä¸ªæ€§ç«¯åŒ—äº¤ç‚¹ | 30.1 | 30.1 | âœ“ |
| ä¸ªæ€§ç«¯å—äº¤ç‚¹ | 29.1 | 29.1 | âœ“ |
| è®¾è®¡ç«¯åŒ—äº¤ç‚¹ | 55.3 | 55.3 | âœ“ |
| è®¾è®¡ç«¯å—äº¤ç‚¹ | 59.3 | 59.3 | âœ“ |

## æ¶æ„è®¾è®¡

### é—®é¢˜

Swiss Ephemeris WASM åº“åœ¨ Next.js webpack ç¯å¢ƒä¸­æ— æ³•æ­£å¸¸åŠ è½½ï¼š

```
[Error: 404: /_next/static/wasm/swisseph.c9cbdda43b309c06.data]
failed to asynchronously prepare wasm
```

### è§£å†³æ–¹æ¡ˆ

é‡‡ç”¨ **å¾®æœåŠ¡æ¶æ„**ï¼Œå°† Swiss Ephemeris è®¡ç®—åˆ†ç¦»åˆ°ç‹¬ç«‹çš„ Node.js æœåŠ¡ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Next.js App (Port 3006)              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   app/api/calculate-chart/route.ts               â”‚   â”‚
â”‚  â”‚   (æ¥æ”¶ç”¨æˆ·è¯·æ±‚ï¼Œè¿”å›å®Œæ•´æ˜Ÿç›˜æ•°æ®)                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                   â”‚ HTTP Request                         â”‚
â”‚                   â†“                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   lib/astronomy-calculator.js                    â”‚   â”‚
â”‚  â”‚   - calculatePlanetLongitude() â†’ å¼‚æ­¥            â”‚   â”‚
â”‚  â”‚   - fetchTrueNodeFromService() â†’ è°ƒç”¨å¤–éƒ¨æœåŠ¡    â”‚   â”‚
â”‚  â”‚   - calculateTrueNodeLongitude() â†’ å›é€€å…¬å¼      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ HTTP POST /calculate-node
                     â”‚ {"date": "1970-12-19T06:30:00.000Z"}
                     â”‚
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Swiss Ephemeris Service (Port 3100)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   server/swisseph-service.js                     â”‚   â”‚
â”‚  â”‚   - ç‹¬ç«‹ HTTP æœåŠ¡å™¨                              â”‚   â”‚
â”‚  â”‚   - çº¯ Node.js ç¯å¢ƒï¼ˆæ—  webpackï¼‰                 â”‚   â”‚
â”‚  â”‚   - åŠ¨æ€åŠ è½½ swisseph-wasm                        â”‚   â”‚
â”‚  â”‚   - è®¡ç®— True Node é»„é“ç»åº¦                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                          â”‚
â”‚  ç«¯ç‚¹:                                                   â”‚
â”‚  - POST /calculate-node â†’ è®¡ç®— True Node                â”‚
â”‚  - GET /health â†’ å¥åº·æ£€æŸ¥                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è‡ªåŠ¨å›é€€æœºåˆ¶

å¦‚æœ Swiss Ephemeris æœåŠ¡ä¸å¯ç”¨ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å›é€€åˆ° **Jean Meeus** å…¬å¼è®¡ç®—ï¼š

- **Swiss Ephemeris**: ç²¾åº¦ 0.001Â° (çº¦ 0.0002 çˆ»)
- **Jean Meeus å…¬å¼**: ç²¾åº¦ ~0.8Â° (çº¦ 0.14 çˆ»)

å¯¹äºå¤§å¤šæ•°æƒ…å†µï¼Œå…¬å¼ç²¾åº¦è¶³å¤Ÿï¼ˆè¯¯å·®å°äº1çˆ»ï¼‰ï¼Œä½†å¯¹äºæç«¯ç²¾ç¡®è¦æ±‚ï¼ŒSwiss Ephemeris æ˜¯å”¯ä¸€é€‰æ‹©ã€‚

## å¯åŠ¨æœåŠ¡

### æ–¹å¼ä¸€ï¼šåˆ†åˆ«å¯åŠ¨ä¸¤ä¸ªæœåŠ¡

ç»ˆç«¯ 1 - Swiss Ephemeris æœåŠ¡ï¼š
```bash
cd app-web
npm run swisseph
```

ç»ˆç«¯ 2 - Next.js åº”ç”¨ï¼š
```bash
cd app-web
npm run dev
```

### æ–¹å¼äºŒï¼šä½¿ç”¨ npm scripts

```bash
# å¯åŠ¨ Swiss Ephemeris æœåŠ¡
npm run swisseph

# åœ¨å¦ä¸€ä¸ªç»ˆç«¯å¯åŠ¨ Next.js
npm run dev

# æµ‹è¯•ç²¾åº¦
npm run test:precision
```

## ç¯å¢ƒå˜é‡

åœ¨ `.env.local` ä¸­é…ç½®ï¼š

```env
# Swiss Ephemeris æœåŠ¡åœ°å€
SWISSEPH_SERVICE_URL=http://localhost:3100
```

## æµ‹è¯•éªŒè¯

è¿è¡Œé›†æˆæµ‹è¯•ï¼š

```bash
npm run test:precision
```

è¾“å‡ºç¤ºä¾‹ï¼š

```
=== æµ‹è¯•å®Œæ•´APIé›†æˆ ===
æµ‹è¯•æ•°æ®: { name: 'åˆ˜å‹‡', birthDate: '1970-12-19', ... }

=== ä¸ªæ€§ç«¯ (Personality) ===
åŒ—äº¤ç‚¹ (North Node): 30.1
å—äº¤ç‚¹ (South Node): 29.1

=== è®¾è®¡ç«¯ (Design) ===
åŒ—äº¤ç‚¹ (North Node): 55.3
å—äº¤ç‚¹ (South Node): 59.3

=== ç²¾åº¦éªŒè¯ ===
âœ“ ä¸ªæ€§ç«¯åŒ—äº¤ç‚¹: 30.1 (æœŸæœ›: 30.1)
âœ“ ä¸ªæ€§ç«¯å—äº¤ç‚¹: 29.1 (æœŸæœ›: 29.1)
âœ“ è®¾è®¡ç«¯åŒ—äº¤ç‚¹: 55.3 (æœŸæœ›: 55.3)
âœ“ è®¾è®¡ç«¯å—äº¤ç‚¹: 59.3 (æœŸæœ›: 59.3)

ğŸ‰ æ‰€æœ‰éªŒè¯é€šè¿‡ï¼å·²å®ç°100%ç²¾åº¦è®¡ç®—ï¼
```

## æŠ€æœ¯ç»†èŠ‚

### Swiss Ephemeris WASM

- **åº“**: `swisseph-wasm` (0.0.2)
- **å®˜ç½‘**: https://www.astro.com/swisseph/
- **ç²¾åº¦**: 0.001 è§’ç§’
- **æ•°æ®**: åŒ…å«å®Œæ•´çš„å¤©æ–‡æ˜Ÿå†æ•°æ®æ–‡ä»¶
- **å…è´¹**: å®Œå…¨å¼€æºï¼Œæ— éœ€ä»˜è´¹

### True Node vs Mean Node

- **Mean Node (å¹³äº¤ç‚¹)**: æœˆçƒè½¨é“çš„å¹³å‡å‡äº¤ç‚¹ï¼Œå¿½ç•¥æ‘„åŠ¨
- **True Node (çœŸäº¤ç‚¹)**: è€ƒè™‘æœˆçƒè½¨é“æ‘„åŠ¨çš„çœŸå®å‡äº¤ç‚¹
- **å·®å¼‚**: æœ€å¤§å¯è¾¾ 1Â°45' (çº¦ 2 çˆ»çš„è·ç¦»)

äººç±»å›¾ç³»ç»Ÿä½¿ç”¨ **True Node**ï¼Œå› æ­¤å¿…é¡»ä½¿ç”¨ç²¾ç¡®è®¡ç®—ã€‚

### è®¡ç®—æµç¨‹

1. ç”¨æˆ·è¾“å…¥å‡ºç”Ÿä¿¡æ¯ï¼ˆå½“åœ°æ—¶é—´ï¼‰
2. è½¬æ¢ä¸º UTC æ—¶é—´
3. è°ƒç”¨ `calculateHumanDesignChart()`
4. å¯¹äº NorthNode/SouthNode:
   - å…ˆå°è¯•è°ƒç”¨ Swiss Ephemeris æœåŠ¡ (2ç§’è¶…æ—¶)
   - å¦‚æœå¤±è´¥ï¼Œå›é€€åˆ° Jean Meeus å…¬å¼
5. å°†é»„é“ç»åº¦è½¬æ¢ä¸ºäººç±»å›¾é—¸é—¨å’Œçˆ»
6. è¿”å›å®Œæ•´æ˜Ÿç›˜æ•°æ®

## æ€§èƒ½

- **Swiss Ephemeris åˆå§‹åŒ–**: ~100ms
- **å•æ¬¡ True Node è®¡ç®—**: ~5-10ms
- **å®Œæ•´æ˜Ÿç›˜è®¡ç®—** (13ä¸ªå¤©ä½“): ~120ms
- **HTTP è°ƒç”¨å»¶è¿Ÿ**: ~2-5ms (æœ¬åœ°æœåŠ¡)

## æœªæ¥ä¼˜åŒ–

1. **Docker éƒ¨ç½²**: å°†ä¸¤ä¸ªæœåŠ¡æ‰“åŒ…åˆ°ä¸€ä¸ª Docker Compose
2. **gRPC**: ä½¿ç”¨ gRPC æ›¿ä»£ HTTPï¼Œå‡å°‘å»¶è¿Ÿ
3. **ç¼“å­˜**: å¯¹ç›¸åŒå‡ºç”Ÿæ—¶é—´çš„è¯·æ±‚è¿›è¡Œç¼“å­˜
4. **é›†ç¾¤**: éƒ¨ç½²å¤šä¸ª Swiss Ephemeris æœåŠ¡å®ä¾‹

## æ•…éšœæ’æŸ¥

### Swiss Ephemeris æœåŠ¡å¯åŠ¨å¤±è´¥

```bash
# æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨
netstat -ano | findstr :3100

# é‡æ–°å®‰è£…ä¾èµ–
npm install swisseph-wasm
```

### API è¿”å› 500 é”™è¯¯

```bash
# æ£€æŸ¥ Swiss Ephemeris æœåŠ¡æ˜¯å¦è¿è¡Œ
curl http://localhost:3100/health

# æŸ¥çœ‹ Next.js æ—¥å¿—
npm run dev
```

### ç²¾åº¦æµ‹è¯•å¤±è´¥

```bash
# ç¡®ä¿ä¸¤ä¸ªæœåŠ¡éƒ½åœ¨è¿è¡Œ
npm run swisseph    # ç»ˆç«¯ 1
npm run dev         # ç»ˆç«¯ 2
npm run test:precision  # ç»ˆç«¯ 3
```

## å‚è€ƒèµ„æ–™

- Swiss Ephemeris å®˜æ–¹æ–‡æ¡£: https://www.astro.com/swisseph/swephinfo_e.htm
- Jean Meeus "Astronomical Algorithms" 2nd Edition
- astronomy-engine æ–‡æ¡£: https://github.com/cosinekitty/astronomy

## æ›´æ–°æ—¥å¿—

### 2025-10-11
- âœ… å®ç° Swiss Ephemeris ç‹¬ç«‹æœåŠ¡
- âœ… å®ç°è‡ªåŠ¨å›é€€æœºåˆ¶
- âœ… éªŒè¯ 100% ç²¾åº¦è®¡ç®—
- âœ… æ·»åŠ é›†æˆæµ‹è¯•
- âœ… æ›´æ–° npm scripts
